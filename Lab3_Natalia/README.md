# Spectral Analysis of SMS Optical Fiber Structures

This repository brings together the development of a spectral analysis project based on simulations with FIMMWAVE, carried out as part of the Scientific Programming course of the Master's Degree in Industrial Automation and Control. The objective of the study is an SMS (Single Mode-Multimode-Single Mode) fibre optic structure, designed to evaluate how variations in its geometry and in the refractive index of the surrounding medium affect the transmission spectra. Based on previous papers, it was identified that a reduction in the diameter of the multimode section of the fibre allows a higher sensitivity of the sensor [1]. Therefore, simulations were performed with an original diameter of 125 µm and a reduced diameter of 25 µm. The results obtained were exported in .csv files and analysed using Python, applying statistical analysis techniques. 
A larger spectral shift in transmission was observed for smaller diameters as the refractive index increased [1, 2, 3], with an average sensitivity of approximately 0.63 nm/RIU. In addition, relevant features were extracted from the spectra, focusing on deep and narrow peaks, whose coordinates (wavelength, transmission, peak shift, etc.) were used for statistical analysis.

The results of the statistical tests were as follows:
`Data/`
`Shapiro-Wilk:/` Showed that the data corresponding to the 125 µm diameter did not follow a normal distribution, while those of 25 µm did.
`ANOVA:/` indicated a significant difference between the groups, suggesting that variations in diameters significantly affect the results.
`Wilcoxon:/` Confirmed that there is a statistically significant difference between the results obtained for both diameters.

This project consists of 4 main phases.
- The design and extraction of the data through simulations in FIMMWAVE.
- Preprocessing of the acquired data, by loading, validation and debugging of the obtained data.
- Statistical analysis, hypothesis testing and data separability analysis.
- Visualisation of the data obtained, histograms, KDE, heat maps.

Each of the previously described phases corresponds to the deliverables (Lab1_Natalia and Lab2_Natalia) and culminates with the final structuring and documentation (Lab3_Natalia), where the code has been modularised, documented and evaluated in terms of its computational complexity. The organisation of folders and files in this repository is detailed below.


## Repository Structure
Repository Structure
This repository is organized into well-structured folders to promote secure and reusable code. The structure is as follows:
### 1. `Data/`
This folder contains all the data files used throughout the project. It is subdivided into. 
- `raw/` # Stores the original, unprocessed data files. For example, you will find the transmission spectra used in Lab 1 and Lab 2 here.
- `processed/` # Automatically generated by the code, this folder contains .csv files resulting from preprocessing, feature extraction, data with wavelength range filtering.
### 2. `Source/`
Contains the source code developed for preprocessing, analysis, and data visualization. This directory is further divided into:
- `preprocessing/` # Scripts for preprocessing data obtained through simulations. 
- `analysis/` # This folder include scripts for statistical analysis, including separability test, variance analysis, and covariance analysis. 
- `visualization/` # Include scripts for visualizing both preprocessed and processed data. 
### 3. `Notebooks/`
This folder holds Google Colab notebooks created throughout the course. Each notebook offers insight into the concepts applied in the project, such as object-oriented programming (OOP), statistical analysis, and data separability.
- `assignments/` # Lab 1 and Lab2 with no change in content, only the way of accessing the data is changed.
- `reporting/` # Notebooks with the results and final visualizations.
### 4. `Results/`
Stores output figures, graphs, and DataFrames obtained from the data processing.
- `figures/` # Includes plots of the transmission spectrum and visualizations related to feature extraction, including histograms and KDE diagrams.
- `Tables/` # Contain various DataFrames resulting from the data analysis. 
### 5. `Test/`
This folder contains test designs to verify the functionality of the code.
- `exploration.py` 
### 6. `Documents/`
Contains assignment instructions provided during the course. 

## Running the Project

To run this project from the terminal in an environment such as Visual Studio Code, follow the steps below:

1. Open the repository folder in Visual Studio Code.
2. Go to the menu: `Terminal -> New Terminal`.
3. Navigate to the main code folder with:

   ```bash
   cd Lab3_Natalia
   ```

4. Install the required libraries by running:

   ```bash
   pip install -r requirements.txt
   ```

5. Run the test script to execute the preprocessing, analysis, and visualization stages:

   ```bash
   python Test/test.py
   ```

   This will generate statistical results, feature extraction tables, and related figures.

6. If you wish to review previous work developed during the course, you can explore the `Notebooks/` folder, where earlier assignments are available.


## References

[1] Y. Cardona-Maya, A. B. Socorro, I. Del Villar, J. L. Cruz, J. M. Corres, and J. F. Botero-Cadavid, “Label-free wavelength and phase detection based SMS fiber immunosensors optimized with cladding etching,” Sens Actuators B Chem, vol. 265, pp. 10–19, Jul. 2018, doi: 10.1016/J.SNB.2018.03.002.

[2] ​​Semenova, Y., Farrell, G., Wu, Q., & Wang, P. (2011). High sensitivity SMS fiber structure based refractometer – analysis and experiment. Optics Express, Vol. 19, Issue 9, Pp. 7937-7944, 19(9), 7937–7944. 10.1364/OE.19.007937

​[3]	A. B. Socorro et al., “Fiber-Optic Immunosensor Based on an Etched SMS Structure,” IEEE Journal of Selected Topics in Quantum Electronics, vol. 23, no. 2, pp. 314–321, Mar. 2017, doi: 10.1109/JSTQE.2016.2633819.

**Subplots:** https://interactivechaos.com/es/manual/tutorial-de-matplotlib/la-funcion-subplots

**Covariance matrix:** https://www.youtube.com/watch?v=jo3XizfYjek

**Heatmap:** https://seaborn.pydata.org/generated/seaborn.heatmap.html

**Verify the type of data and any missing values**  https://medium.com/@aditib259/data-cleaning-in-python-how-to-handle-missing-values-outliers-more-8f8b68b12436 

**Connect the DataFrame** https://pandas.pydata.org/docs/user_guide/merging.html 

**Calculate the spectral width** https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.peak_widths.html 

**Calculate the prominence** https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.peak_prominences.html 

**Wilcoxon test** https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.wilcoxon.html 

